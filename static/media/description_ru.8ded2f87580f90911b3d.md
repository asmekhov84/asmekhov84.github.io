Целью этой работы было создание системы автоматического контроля качества бутылочных ПЭТ преформ, движущихся по конвейерной ленте. По требованию заказчика контроль должен был производиться по изображениям, получаемым с одной цветной камеры, закреплённой над конвейерной лентой. Преформы при этом расположены на ленте неупорядоченно. Контролируемыми параметрами являются цвет преформы и наличие посторонних вкраплений.

Так как это достаточно комплексная задача, на первом этапе было решено разработать алгоритм отделения изображений преформ от фона, то есть сегментации.

Преформы могут быть множества различных оттенков, в том числе полупрозрачные. Конвейерная лента имеет неоднородную текстуру с тёмными и светлыми участками. Также на изображении преформы могут возникать блики различной формы и площади. Все эти факторы сильно усложняют задачу сегментации. В таких условиях использование простых методов типа сегментации по яркости или цвету даёт неприемлемый результат. В связи с этим было принято решение использовать для сегментации свёрточную нейронную сеть.

За основу я взял [работу](https://github.com/arahusky/Tensorflow-Segmentation/), в которой авторы использовали свёрточную нейросеть для сегментации изображений лиц. Их модель, в свою очередь, была основана на архитектуре [SegNet](http://mi.eng.cam.ac.uk/projects/segnet/). Для реализации модели был использован фреймворк TensorFlow.

Я скорректировал модель для уменьшения числа варьируемых параметров и, соответственно, сокращения требуемого объёма памяти и времени обучения.

Для обучения модели была сформирована и вручную размечена выборка из порядка 100 изображений преформ. Выборка была искусственно дополнена при помощи операций сдвига, отражения и размытия. Все изображения были разделены на обучающую и тестовую выборки в соотношении 0.7/0.3. Результаты сегментации для тестового набора данных показаны на рисунках ниже. Как видно, обученная модель даёт неплохой результат даже для прозрачных преформ.
